---
title: "Capital Budget Funding in Toronto"
subtitle: "An Analysis of the Funding Disparties Across Toronto Wards (2022 - 2031)"
author: 
  - Maria Mangru 
thanks: "Code and data are available at: https://github.com/MariaMangru/Capital-Budget-Allocations-and-Median-Household-Income."
date: today
date-format: long
abstract: "This research examines the allocation of capital funding across Toronto's 25 wards and explores how these allocations correspond with various socioeconomic indicators. The analysis reveals significant disparities in per capita funding, with higher-income wards often receiving more funding than lower-income wards."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

#### Workspace setup ####
library(dplyr)
library(tidyverse)
library(readr)
library(knitr)
library(kableExtra)
library(scales)

### Data handling ###
# Import cleaned data 
budget_data_clean <- read_csv("../data/analysis_data/2022-2031-budget_data.csv")

# Identify year columns
year_cols <- as.character(2022:2031)


# Reshape data to long format
budget_data_long <- budget_data_clean |>
  pivot_longer(
    cols = all_of(year_cols),
    names_to = "Year",
    values_to = "Funding"
  )

### Summing funding values ### 

# Total overall funding per ward number 
total_funding_ward <- budget_data_clean |>
  group_by(`Ward Number`) |>
  summarise(
    Total_Funding = sum(across(all_of(year_cols)), na.rm = TRUE)
  ) |>
  arrange(desc(Total_Funding))


# Funding for each year per ward number 
funding_yearly_ward <- budget_data_long |>
  group_by(`Ward Number`, Year) |>
  summarise(Funding = sum(Funding, na.rm = TRUE)) |>
  arrange(`Ward Number`, Year)


# Total funding per program/agency per ward number 
total_funding_program_ward <- budget_data_clean |>
  group_by(`Ward Number`, `Program/Agency Name`) |>
  summarise(Total_Funding = sum(across(all_of(year_cols)), na.rm = TRUE)) |>
  arrange(`Ward Number`, desc(Total_Funding))


# Yearly funding per program/agency per ward number - maybe remove later
funding_yearly_program_ward <- budget_data_long |>
  group_by(`Ward Number`, `Program/Agency Name`, Year) |>
  summarise(
    Funding = sum(Funding, na.rm = TRUE)
  ) |>
  arrange(`Ward Number`, `Program/Agency Name`, Year)

```

# Introduction

Toronto, often referred to as a cultural mosaic, is home to a diverse population with roots from all around the world. It is also city where its neighbourhoods vary significantly in income, educational attainment, and demographic makeup. The allocation of capital funding plays an important role in shaping the infrastructure and services available to residents. This impacts their quality of life and access to opportunities.

Despite the importance of equitable funding, there is evidence that budget distributions may not align with the needs of different communities. \[Write about these two:https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8186789/ , http://neighbourhoodchange.ca/documents/2016/05/walks-etal-2016-income-inequality-toronto-york-rp-238.pdf\]

By analyzing data from the City of Toronto's Capital Budget & Plan, as well as its Ward Profiles, this research finds disparities in per capita funding among the 25 wards. The findings indicate that higher-income wards tend to receive more funding per capita than lower-income wards.

The remainder of the paper is organized as follows: Section \ref{sec-data} describes the data sources and methodology used in the analysis. Section \ref{sec-results} presents the results, highlighting key findings. Section \ref{sec-discussion} discussed the implications of the findings as well as limitations and recommendations for next steps.

# Data {#sec-data}

## Data Sources

This research utilized two primary datasets provided by the City of Toronto's Open Data Portal.

1.  Capital Budget & Plan By Ward (2022-2031): \\ This dataset contains the approved capital budget and plan for each of Toronto's 25 wards over a ten-year period from 2022 to 2031. It includes funding allocations for various programs such as Children's Services, Parks, Foresty & Recreation, Transportation Services, and others. The data provides a detailed breakdown of how much funding each ward is set to receive for specific projects and services.

2.  Ward Profiles (2021): \\ This dataset provides comprehensive socioeconomic information for each ward based on the 2021 census. It was filtered to remain the variables which were most useful for this research. These are: Total Population, Median Household Income, Prevalence of Low Income Households, Educational Attainment, Immigration Status, Visible Minority Population. \[may need to include others, depends on what I decide to go with in the end.\]

# Results {#sec-results}

Lots of tables and graphs to be included here once they're properly formatted!


```{r echo=FALSE, message=FALSE, warning=FALSE}
# Yearly Funding per Ward Number with Total Column
funding_yearly_ward_table <- funding_yearly_ward |>
  pivot_wider(names_from = Year, values_from = Funding, values_fill = 0) |> 
  rowwise() |> 
  mutate(`Total Funding` = sum(c_across(all_of(year_cols)))) |> 
  ungroup() |> 
  mutate_at(vars(all_of(year_cols), `Total Funding`), ~ dollar(.)) |> 
  arrange(`Ward Number`)

funding_yearly_ward_table |> 
  kable(
    col.names = c("Ward Number", year_cols, "Total Funding"),
    caption = "Yearly Funding for Wards"
  ) |> 

  kableExtra::kable_styling(bootstrap_options = "condensed", full_width = F, font_size = 6, position = "center")

```




# Discussion {#sec-discussion}

## First discussion point {#sec-first-point}

## Second discussion point

## Third discussion point

## Weaknesses and next steps



\newpage

# References
